<!DOCTYPE html>
<html>
  <head>
    <title>Wilderness Now</title>
    {% include head-meta.html %}
  </head>
  <body class="activity-category-layout-2 overlay-closed">




    {% include navigation.html %}


    <script>
      var locations = [

      {% for activity in site.data[page.slug] %}

      {% assign coords = activity.coords | split: ', ' %}
      {% assign latitude = coords[0] %}
      {% assign longitude = coords[1] %}
        {% if latitude %}
          {
            'name': '{{activity.title}}',
            'lat': {{latitude}},
            'long': {{longitude}},
            'slug': '{{activity.slug}}',
            'nb_visits':87
          }{% if forloop.last != true %},{% endif %}
        {% endif %}
      {% endfor %}
      ]

      var symbols;
      var circleRadius = 3;
      $(function() {
        function map(cont, clustering) {
          var map = kartograph.map(cont);
          map.loadMap('/GBR.svg', function() {
              // map.addLayer('context', {
              //     styles: {
              //         stroke: '#aaa',
              //         fill: '#f6f4f2'
              //     }
              // });
              map.addLayer('regions', {
                  id: 'bg',
                  styles: {
                      stroke: '#999',
                      'stroke-width': 1.5,
                      'stroke-linejoin': 'round'
                  }
              });
              map.addLayer('regions', {
                  title: function(d) { return d.name },
                  styles: {
                      stroke: '#fff',
                      fill: '#fff'
                  }
              });
              var scale = kartograph.scale.sqrt(locations.concat([{ nb_visits: 0 }]), 'nb_visits').range([2, 30]);
              symbols = map.addSymbols({
                  type: kartograph.Bubble,
                  data: locations,
                  location: function(city) {
                      return [city.long, city.lat];
                  },
                  radius: circleRadius,
                  click: function(d) {
                    moveChosenActivity(d.slug)
                    selectActivity(d.slug);
                  },
                  sortBy: 'radius desc',
                  style: 'fill:#000; stroke: #fff; fill-opacity: 1;',
              });
            }, { padding: -75 });
        }
        map('#map0');

        $('.activity-card').hover(function() {
          var card = $(this)
          selectActivity(card.attr('id'));
        })
      });
      var timeout;
      function selectActivity(slug) {
        $.each(symbols.symbols, function(i,k) {
          k.radius = circleRadius;
          k.update();
          $('.card').removeClass('selected')
          $('#'+slug).addClass('selected');

          if (slug != undefined) {
            if (k.data.slug == slug) {

              k.radius = 6
              k.update()
              clearTimeout(timeout);
              timeout = setTimeout(selectActivity, 5000);

            }
          }
        })
      }

      function moveChosenActivity(slug) {
        var toEnd = $('.cd-1').children('.card').first();

        $(toEnd).insertAfter('#'+slug)
        $('#'+slug).prependTo('.cd-1')
      }

    </script>

    <header class="full-width-image banner logo-overlay" style="background-image: url({{site.data.config.cdn}}/{% if page.image-wide %}{{page.image-wide}}{% else %}{{page.image}}{%endif%})">
      <div class="wn"></div>


      <div class="banner-map uk-map">
        <div id="map0"></div>
      </div>



      <div class="container">
        <div class="row">
          <div class="col-md-12">
            <h1>
              <img src="{{ site.data.config.cdn }}/img/wilderness_now_logo_01_white.png" alt="WN">
              {{ page.title }}
            </h1>
          </div>
          <div class="col-md-6 col-md-offset-2">
            <blockquote class="blockquote">
              <p class="m-b-0">{{page.quote}}</p><br>
              <cite>{{page.quoth}}</cite>
            </blockquote>
          </div>
        </div>
      </div>
    </header>

    <div class="full-width-white">



      <div class="container">

        <div class="row">
          <div class="col-md-10 col-md-offset-1 col-sm-12">
            <section class="introduction">
              <p>{{page.includes}}</p>
              <img class="down-arrow" src="{{site.data.config.cdn}}/img/scroll_arrow.svg" alt="Down">
            </section>
          </div>
        </div>
      </div>
    </div>

    <div class="full-width-grey">
      <div class="container">
        <div class="row">
<!--           <div class="col-md-3">

            <div class="row">
              <div class="col-md-12">

              </div>
            </div>


          </div>
          <div class="col-md-9">
            <div class="row"> -->
              <div class="col-md-12">
                {% include activities-table.html %}
              </div>
<!--             </div>
         </div>
 -->
        </div>
        <div class="row">
          <div class="col-md-12">
            <div class="card card-inverse" style="background-color: #333; border-color: #333;">
              <div class="card-block">
                <h3 class="card-title">Did you know</h3>
                <p class="card-text">{{page.dyk}}</p>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>
    {% include footer.html %}
  </body>
</html>